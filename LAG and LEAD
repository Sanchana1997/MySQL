#Concept of LAG and LEAD Fuction

Lag function - https://www.sqlshack.com/sql-lag-function-overview-and-examples/
Lead function - https://www.sqlshack.com/overview-and-examples-of-sql-server-lead-function/

Syntax:
#Lead
LEAD ( expression [, offset [, default] ] ) OVER ( [ query_partition_clause ] order_by_clause )
#Lag
LAg  ( expression [, offset [, default] ] ) OVER ( [ query_partition_clause ] order_by_clause )


Leetcode Question- 603. Consecutive Available Seats - TSQL 

Answer :
SELECT 
     seat_id
FROM
     (SELECT 
          seat_id, 
          free,
          LAG(free,1) OVER (ORDER BY seat_id) AS lag_free,
          LEAD(free,1) OVER (ORDER BY seat_id) AS lead_free
      FROM Cinema ) AS Cine
WHERE (free = 1 AND lag_free = 1 ) OR 
(free = 1 AND lead_free = 1)
;


#Concept ranking and partitioning using over 
reference - https://www.ptr.co.uk/blog/sql-server-aggregate-functions-over-clause
select player_id , event_date, 
sum(games_played) over (partition by player_id order by event_date) as games_played_so_far
from Activity 

Leet code question 1179. Reformat Department Table

#Pivot table concept
SELECT id, 
[Jan] AS Jan_Revenue,
[Feb] AS Feb_Revenue,
[Mar] AS Mar_Revenue,
[Apr] AS Apr_revenue,
[May] AS May_revenue,
[Jun] AS Jun_revenue,
[Jul] AS Jul_revenue,
[Aug] AS Aug_revenue,
[Sep] AS Sep_revenue,
[Oct] AS Oct_revenue,
[Nov] AS Nov_revenue,
[Dec] AS Dec_revenue
FROM 
(select id, revenue, month
FROM Department
) As src
PIVOT 
(
MAX(revenue) 
FOR month in ([Jan],[Feb],[Mar],[Apr],[May],[Jun],[Jul],[Aug],[Sep],[Oct],[Nov],[Dec])
) AS pvt

